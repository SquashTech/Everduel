<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Everduel</title>
    
    <!-- Single CSS File -->
    <link rel="stylesheet" href="css/game.css">
</head>
<body>
    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="app-loading">
        <div>🎮 Loading Everduel...</div>
    </div>

    <!-- Scenario Selection Screen -->
    <div id="scenarioSelection" class="scenario-selection-screen">
        <!-- Card Library Button -->
        <button id="cardLibraryBtn" class="card-library-btn" title="View all cards in the game">
            📚 Card Library
        </button>
        
        <div class="scenario-header">
            <h1>Welcome to Everduel!</h1>
            <h2>Choose a scenario:</h2>
        </div>
        
        <div class="scenario-grid">
            <!-- Gray Scenarios (Tutorial/Easy) -->
            <button class="scenario-btn scenario-gray" data-scenario="tutorial-1">
                <div class="scenario-icon">📚</div>
                <div class="scenario-title">Easy Mode</div>
            </button>
            <button class="scenario-btn scenario-gray" data-scenario="tutorial-2">
                <div class="scenario-icon">📐</div>
                <div class="scenario-title">Behind the Curve</div>
            </button>
            
            <!-- Red Scenarios (Easy) -->
            <button class="scenario-btn scenario-red" data-scenario="easy-1">
                <div class="scenario-icon">🏘️</div>
                <div class="scenario-title">It Takes a Village</div>
            </button>
            <button class="scenario-btn scenario-red" data-scenario="easy-2">
                <div class="scenario-icon">🐉</div>
                <div class="scenario-title">Draconic Awakening</div>
            </button>
            
            <!-- Yellow Scenarios (Medium) -->
            <button class="scenario-btn scenario-yellow" data-scenario="medium-1">
                <div class="scenario-icon">🐻</div>
                <div class="scenario-title">Beasts of Burden</div>
            </button>
            <button class="scenario-btn scenario-yellow" data-scenario="medium-2">
                <div class="scenario-icon">🦅</div>
                <div class="scenario-title">The Sky Falls</div>
            </button>
            
            <!-- Green Scenarios (Hard) -->
            <button class="scenario-btn scenario-green" data-scenario="hard-1">
                <div class="scenario-icon">🏹</div>
                <div class="scenario-title">An Arrow to the Knee</div>
            </button>
            <button class="scenario-btn scenario-green" data-scenario="hard-2">
                <div class="scenario-icon">👹</div>
                <div class="scenario-title">Goofy Goblins</div>
            </button>
            
            <!-- Blue Scenarios (Very Hard) -->
            <button class="scenario-btn scenario-blue" data-scenario="vhard-1">
                <div class="scenario-icon">✨</div>
                <div class="scenario-title">Mana Cheating</div>
            </button>
            <button class="scenario-btn scenario-blue" data-scenario="vhard-2">
                <div class="scenario-icon">🔥</div>
                <div class="scenario-title">Burn It All Down</div>
            </button>
            
            <!-- Purple Scenarios (Expert) -->
            <button class="scenario-btn scenario-purple" data-scenario="expert-1">
                <div class="scenario-icon">👻</div>
                <div class="scenario-title">The Goal is Souls</div>
            </button>
            <button class="scenario-btn scenario-purple" data-scenario="expert-2">
                <div class="scenario-icon">💀</div>
                <div class="scenario-title">Death is Only the Beginning</div>
            </button>
        </div>
        
        <!-- Multiplayer Coming Soon Button -->
        <div class="multiplayer-section">
            <button class="multiplayer-coming-soon-btn" disabled>
                <div class="multiplayer-icon">🌐</div>
                <div class="multiplayer-title">Multiplayer</div>
                <div class="multiplayer-subtitle">Coming Soon</div>
            </button>
        </div>
        
        <!-- Reset Progress Button -->
        <button id="resetProgressBtn" class="reset-progress-btn-corner">
            🗑️
        </button>
    </div>

    <!-- Scenario Confirmation Modal -->
    <div id="scenarioConfirmationModal" class="modal-overlay scenario-confirmation-modal hidden">
        <div class="modal-content scenario-confirmation-content">
            <div class="scenario-confirmation-header">
                <div class="confirmation-scenario-icon" id="confirmationScenarioIcon">🎮</div>
                <div class="confirmation-scenario-title" id="confirmationScenarioTitle">Scenario Name</div>
            </div>
            <div class="scenario-confirmation-body">
                <div class="scenario-description" id="scenarioDescription">
                    Are you ready to begin this scenario?
                </div>
                <div class="scenario-details" id="scenarioDetails">
                    <!-- Additional scenario details will be populated here -->
                </div>
            </div>
            <div class="scenario-confirmation-actions">
                <button class="btn btn-secondary scenario-cancel-btn" id="scenarioConfirmationCancel">Cancel</button>
                <button class="btn btn-primary scenario-confirm-btn" id="scenarioConfirmationConfirm">Start Scenario</button>
            </div>
        </div>
    </div>

    <div class="game-container hidden">
        <!-- AI Player Area -->
        <div class="player-area">
            <div class="battlefield-container">
                <div class="battlefield" id="aiBattlefield">
                    <!-- Dragon Flame Display for AI -->
                    <div class="dragon-flame-display battlefield-dragon-flame" id="aiDragonFlame">
                        <span class="dragon-flame-icon">🔥</span>
                        <span class="dragon-flame-count">0</span>
                    </div>
                    <!-- Souls Display for AI -->
                    <div class="souls-display battlefield-souls" id="aiBattlefieldSouls">
                        <span class="souls-icon">👻</span>
                        <span class="souls-count" id="aiSouls">0</span>
                    </div>
                    <!-- Turn Indicator for AI -->
                    <div class="turn-indicator battlefield-turn" id="aiBattlefieldTurn">
                        <span class="turn-icon">⚔️</span>
                    </div>
                    <!-- AI Back Row (slots 3,4,5) displayed at top -->
                    <div class="battlefield-row">
                        <div class="slot-container">
                            <div class="slot back-row" data-player="ai" data-slot="3"></div>
                            <div class="slot-buff" id="ai-slot-3-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot back-row" data-player="ai" data-slot="4"></div>
                            <div class="slot-buff" id="ai-slot-4-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot back-row" data-player="ai" data-slot="5"></div>
                            <div class="slot-buff" id="ai-slot-5-buff" data-buff="none"></div>
                        </div>
                    </div>
                    <!-- AI Front Row (slots 0,1,2) displayed at bottom -->
                    <div class="battlefield-row">
                        <div class="slot-container">
                            <div class="slot front-row" data-player="ai" data-slot="0"></div>
                            <div class="slot-buff" id="ai-slot-0-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot front-row" data-player="ai" data-slot="1"></div>
                            <div class="slot-buff" id="ai-slot-1-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot front-row" data-player="ai" data-slot="2"></div>
                            <div class="slot-buff" id="ai-slot-2-buff" data-buff="none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Player Info - Separate Box -->
        <div class="player-info-box ai-info">
            <h3>Opponent</h3>
            <button class="btn btn-deck btn-deck-hand" id="aiDeckBtn" title="View Opponent Deck">Deck: <span id="aiDeckCount">0</span></button>
            <div class="player-stats-compact">
                <div class="health">🛡️ <span id="aiHealth">30</span></div>
                <div class="gold">💰 <span id="aiGoldCurrent">2</span></div>
            </div>
        </div>

        <!-- Player Area -->
        <div class="player-area">
            <div class="battlefield-container">
                <div class="battlefield" id="playerBattlefield">
                    <!-- Dragon Flame Display for Player -->
                    <div class="dragon-flame-display battlefield-dragon-flame" id="playerDragonFlame">
                        <span class="dragon-flame-icon">🔥</span>
                        <span class="dragon-flame-count">0</span>
                    </div>
                    <!-- Souls Display for Player -->
                    <div class="souls-display battlefield-souls" id="playerBattlefieldSouls">
                        <span class="souls-icon">👻</span>
                        <span class="souls-count" id="playerSouls">0</span>
                    </div>
                    <!-- Turn Indicator for Player -->
                    <div class="turn-indicator battlefield-turn" id="playerBattlefieldTurn">
                        <span class="turn-icon">⚔️</span>
                    </div>
                    <div class="battlefield-row">
                        <div class="slot-container">
                            <div class="slot front-row" data-player="player" data-slot="0"></div>
                            <div class="slot-buff" id="player-slot-0-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot front-row" data-player="player" data-slot="1"></div>
                            <div class="slot-buff" id="player-slot-1-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot front-row" data-player="player" data-slot="2"></div>
                            <div class="slot-buff" id="player-slot-2-buff" data-buff="none"></div>
                        </div>
                    </div>
                    <div class="battlefield-row">
                        <div class="slot-container">
                            <div class="slot back-row" data-player="player" data-slot="3"></div>
                            <div class="slot-buff" id="player-slot-3-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot back-row" data-player="player" data-slot="4"></div>
                            <div class="slot-buff" id="player-slot-4-buff" data-buff="none"></div>
                        </div>
                        <div class="slot-container">
                            <div class="slot back-row" data-player="player" data-slot="5"></div>
                            <div class="slot-buff" id="player-slot-5-buff" data-buff="none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Game Log Display - Green Box -->
        <div class="game-log-display">
            <div class="game-log-header">📜 Game Log</div>
            <div class="game-log-content" id="gameLogDisplay">
                <div class="game-log-entry">🎮 Welcome to Everduel!</div>
                <div class="game-log-entry">🔄 Game started - Your turn</div>
            </div>
        </div>
        
        <!-- Player Info - Separate Box -->
        <div class="player-info-box player-info">
            <h3>Player</h3>
            <div class="player-stats-compact">
                <div class="health">🛡️ <span id="playerHealth">30</span></div>
                <div class="gold">💰 <span id="playerGoldCurrent">2</span></div>
            </div>
            <button class="btn btn-primary" id="endTurnBtn">End Turn</button>
        </div>

        <!-- Hand Cards - Extended Bottom Right -->
        <div class="hand-cards-horizontal" id="playerHand">
            <div class="hand-header">
                <button class="btn btn-secondary btn-hand-action" id="spellDraftBtn">📖 Spellbook 📖</button>
                <button class="btn btn-deck btn-deck-hand" id="playerDeckBtn" title="View Your Deck">Your Deck: <span id="playerDeckCount">0</span></button>
                <button class="btn btn-deck-draw btn-hand-action" id="drawDeckBtn">Draw from Deck (3 💰)</button>
            </div>
            <div class="hand-cards-container" id="handCardsContainer">
                <!-- Cards will be dynamically added here -->
            </div>
        </div>

        <!-- Fixed Sidebar -->
        <div class="fixed-controls">
            <div class="control-section">
                <h4>Information</h4>
                <button class="btn btn-secondary" id="howToPlayBtnSidebar">How to Play</button>
            </div>
            
            <div class="control-section">
                <h4>Draft Cards</h4>
                <button class="btn btn-primary" id="draftTier1Btn" data-tier="1">
                    <div class="tier-info">
                        <span class="tier-name">Tier 1 -</span>
                        <span class="tier-cost gold-cost">2 💰</span>
                    </div>
                    <span class="remaining-count" id="tier1Count">25</span>
                </button>
                <button class="btn btn-primary" id="draftTier2Btn" data-tier="2">
                    <div class="tier-info">
                        <span class="tier-name">Tier 2 -</span>
                        <span class="tier-cost gold-cost">4 💰</span>
                    </div>
                    <span class="remaining-count" id="tier2Count">25</span>
                </button>
                <button class="btn btn-primary" id="draftTier3Btn" data-tier="3">
                    <div class="tier-info">
                        <span class="tier-name">Tier 3 -</span>
                        <span class="tier-cost gold-cost">6 💰</span>
                    </div>
                    <span class="remaining-count" id="tier3Count">25</span>
                </button>
                <button class="btn btn-primary" id="draftTier4Btn" data-tier="4">
                    <div class="tier-info">
                        <span class="tier-name">Tier 4 -</span>
                        <span class="tier-cost gold-cost">8 💰</span>
                    </div>
                    <span class="remaining-count" id="tier4Count">25</span>
                </button>
                <button class="btn btn-primary" id="draftTier5Btn" data-tier="5">
                    <div class="tier-info">
                        <span class="tier-name">Tier 5 -</span>
                        <span class="tier-cost gold-cost">10 💰</span>
                    </div>
                    <span class="remaining-count" id="tier5Count">25</span>
                </button>
            </div>
            
        </div>
    </div>

    <!-- Draft Modal -->
    <div id="draftOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <div id="draftInfo">Choose a Card</div>
            </div>
            <div id="draftCards" class="draft-options"></div>
            <div class="draft-controls">
                <button id="rerollBtn" class="reroll-btn">🎲 Reroll (1 Gold)</button>
                <div id="draftGoldDisplay" class="draft-gold-display">💰 0</div>
            </div>
        </div>
    </div>

    <!-- Deck Modal -->
    <div id="deckModal" class="modal-overlay">
        <div class="modal-content deck-modal">
            <button class="modal-close">×</button>
            <div class="modal-header">
                <h2>Your Deck</h2>
            </div>
            <div class="deck-description">
                <p>Cards are ordered from left to right by the order they will be drawn from your deck.</p>
            </div>
            <div id="deckContent" class="deck-cards"></div>
        </div>
    </div>

    <!-- Game End Modal -->
    <div id="gameEndModal" class="modal-overlay game-end-modal hidden">
        <div class="modal-content game-end-content">
            <div class="game-end-header">
                <div class="game-end-icon" id="gameEndIcon">🏆</div>
                <h2 id="gameEndTitle">Victory!</h2>
            </div>
            <div class="game-end-actions">
                <button class="btn btn-primary game-end-btn" id="returnToScenariosBtn">Return to Scenarios</button>
            </div>
        </div>
    </div>

    <!-- Keyword Tooltip -->
    <div id="keywordTooltip" class="keyword-tooltip" style="display: none;">
        <div class="tooltip-header"></div>
        <div class="tooltip-description"></div>
    </div>

    <!-- How to Play Modal -->
    <div id="howToPlayModal" class="modal-overlay">
        <div class="modal-content how-to-play-content">
            <button class="modal-close">×</button>
            <h2>How to Play - Everduel</h2>
            
            <h3>🎯 Objective</h3>
            <p>Reduce your opponent's health from 30 to 0 by strategically drafting cards, placing units, and attacking.</p>
            
            <h3>💰 Gold System</h3>
            <p>• Both players start with 2 max gold, increasing by 1 each turn</p>
            <p>• You start each turn with your maximum gold amount</p>
            <p>• Gold progression: Turn 1 (2 gold) → Turn 2 (3 gold) → Turn 3 (4 gold)...</p>
            
            <h3>🎴 Hand & Battlefield</h3>
            <p>• Keep up to <strong>3 cards</strong> in your hand</p>
            <p>• Place units from hand onto your battlefield (3x2 grid: Front Row & Back Row)</p>
            <p>• Units cannot attack the turn they're played (unless they have Rush)</p>
            <p>• When units die, they go to the bottom of your deck</p>
            <p>• You can draw from your deck for 3 gold</p>
            
            <h3>⚔️ Combat System</h3>
            <p>Clicking on a unit will initiate its automatic attack.</p>
            <p><strong>Column-Based Attacking:</strong> Units attack enemies in their column deterministically</p>
            
            <h4>🎯 Normal Unit Targeting:</h4>
            <p>1. Attack Front Row enemy (if present)</p>
            <p>2. Attack Back Row enemy (if front empty)</p>
            <p>3. Attack enemy player directly (if column empty)</p>
            
            <h4>🏹 Special Unit Types:</h4>
            <p><strong>Ranged:</strong> Ignore Front Row, attack Back Row → Player directly</p>
            <p><strong>Flying:</strong> Always attack player, UNLESS enemy Flying unit in same column (then target frontmost Flying)</p>
            
            <h4>⚡ Combat Mechanics:</h4>
            <p>• Units deal attack damage to each other simultaneously</p>
            <p>• When health reaches 0, unit is destroyed</p>
            
            <h3>✨ Slot Buffs</h3>
            <p>Some abilities can permanently buff battlefield slots, granting bonuses to any unit placed there:</p>
            <p>• Slot buffs persist for the entire game</p>
            <p>• They apply to any unit currently in that slot</p>
            <p>• When a new unit is placed in a buffed slot, it gains those bonuses</p>
            <p>• Damaged units keep their damage when slot buffs are applied</p>
            <p>• Look for the buff indicator (+X/+Y) on battlefield slots</p>
            
            <h3>🛡️ Keyword Abilities</h3>
            <p><strong>Unleash:</strong> Trigger effect when unit is summoned</p>
            <p><strong>Flying:</strong> Always attacks player unless enemy Flying in column</p>
            <p><strong>Trample:</strong> Excess damage dealt to unit carries over to player</p>
            <p><strong>Sneaky:</strong> First attack targets enemy player directly</p>
            <p><strong>Rush:</strong> Can attack the turn it's played</p>
            <p><strong>Ranged:</strong> Ignores Front Row when attacking</p>
            <p><strong>Kindred:</strong> Triggers when summoning unit with same Tag</p>
            <p><strong>Manacharge:</strong> Triggers when you use Blue Unleash abilities</p>
            <p><strong>Last Gasp:</strong> Triggers when unit is destroyed</p>
            <p><strong>Banish:</strong> Removed from game permanently (doesn't return to deck)</p>
            
        </div>
    </div>

    <!-- Game Log Panel -->
    <div id="gameLogPanel" class="game-log-panel hidden">
        <div class="log-header">
            <h3>📜 Game Log</h3>
            <div class="log-controls">
                <button class="log-clear-btn" id="gameLogClearBtn">Clear</button>
                <button class="log-close-btn" id="gameLogCloseBtn">×</button>
            </div>
        </div>
        <div class="log-entries" id="gameLogEntries">
            <div class="log-entry">🎮 Welcome to Everduel!</div>
            <div class="log-entry">🔄 Game started - Your turn</div>
        </div>
    </div>

    <!-- Card Library Modal -->
    <div id="cardLibraryModal" class="modal-overlay card-library-modal hidden">
        <div class="modal-content card-library-content">
            <div class="card-library-header">
                <h2>📚 Card Library</h2>
                <button class="modal-close-btn" id="cardLibraryCloseBtn">×</button>
            </div>
            <div class="card-library-body">
                <div class="tier-section" data-tier="1">
                    <h3 class="tier-title">Tier 1</h3>
                    <div class="cards-grid" id="tier1Cards"></div>
                </div>
                <div class="tier-section" data-tier="2">
                    <h3 class="tier-title">Tier 2</h3>
                    <div class="cards-grid" id="tier2Cards"></div>
                </div>
                <div class="tier-section" data-tier="3">
                    <h3 class="tier-title">Tier 3</h3>
                    <div class="cards-grid" id="tier3Cards"></div>
                </div>
                <div class="tier-section" data-tier="4">
                    <h3 class="tier-title">Tier 4</h3>
                    <div class="cards-grid" id="tier4Cards"></div>
                </div>
                <div class="tier-section" data-tier="5">
                    <h3 class="tier-title">Tier 5</h3>
                    <div class="cards-grid" id="tier5Cards"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification" id="notification"></div>

    <!-- Main Game Script - Using Simple Implementation -->
    <script type="module" src="src/Main.js"></script>
    
    <script>
        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🎮 Everduel starting...');
        });
    </script>
</body>
</html>